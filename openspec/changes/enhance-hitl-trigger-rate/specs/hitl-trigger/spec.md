## MODIFIED Requirements

### Requirement: HITL Trigger Scenarios

系统 SHALL 在以下场景主动触发HITL表单收集用户信息：

**主动询问策略 (Proactive Inquiry)**
- 首次对话或新会话开始时，主动了解用户基本偏好
- 检测到用户是新用户（相关记忆较少）时，触发"了解您"类型表单

**话题深化触发 (Topic Deepening)**
- 用户提到某个领域但未详细说明偏好时，生成该领域的详细偏好表单
- 用户表达模糊喜好（如"我喜欢运动"、"我对编程感兴趣"）时，深化询问具体偏好

**情感驱动触发 (Emotion-driven)**
- 检测到积极情绪时，可收集让用户感到开心的事物
- 检测到消极情绪（如焦虑、困惑）时，可收集用户当前的困扰点

**记忆补全触发 (Memory Gap Detection)**
- 对话中发现相关记忆缺失时，主动通过表单补全
- 用户行为暗示某偏好但记忆中没有记录时，确认并记录

#### Scenario: 新用户首次对话触发
- **WHEN** 用户首次与系统对话，且系统未检索到相关长期记忆
- **THEN** 系统 SHOULD 在前3轮对话内生成一个"了解您"类型的HITL表单
- **AND** 表单应包含基础偏好字段（如称呼、感兴趣的话题等）

#### Scenario: 模糊偏好深化触发
- **WHEN** 用户表达模糊偏好（如"我喜欢音乐"）
- **THEN** 系统 SHOULD 生成该领域的详细偏好表单
- **AND** 表单选项应覆盖该领域的常见分类

#### Scenario: 积极情绪响应触发
- **WHEN** 用户表达积极情绪且提及某事物（如"今天心情很好，刚看完一部好电影"）
- **THEN** 系统 MAY 生成相关偏好收集表单（如电影类型偏好）

#### Scenario: 记忆空白补全触发
- **WHEN** 用户提到某个话题，系统检索到相关记忆为空
- **AND** 该话题对个性化响应有价值
- **THEN** 系统 SHOULD 生成表单收集该话题的偏好信息

### Requirement: HITL Negative Trigger Scenarios

系统 SHALL NOT 在以下场景触发HITL表单：

- 用户正在寻求帮助解决紧急问题
- 用户已明确给出答案，无需再次确认
- 简单的是/否问题
- 纯开放性探讨，不涉及具体偏好

#### Scenario: 紧急问题场景跳过表单
- **WHEN** 用户表达紧急需求（如"帮我快速解决..."、"马上要用..."）
- **THEN** 系统 SHALL NOT 生成HITL表单
- **AND** 应直接提供帮助

#### Scenario: 已有明确答案时跳过表单
- **WHEN** 用户已在消息中给出明确答案（如"我要Python"、"选A"）
- **THEN** 系统 SHALL NOT 生成询问该选择的表单
- **AND** 应直接基于用户的选择响应
